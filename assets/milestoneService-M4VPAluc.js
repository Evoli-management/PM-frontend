import{a}from"./index-CSUE7nBL.js";const i=(o,e)=>{if(console.error(`Error ${o}:`,e),e.response&&e.response.data&&e.response.data.message){const t=Array.isArray(e.response.data.message)?e.response.data.message.join(", "):e.response.data.message;throw console.error("Backend validation errors:",t),new Error(`Failed to ${o}. ${t}`)}throw new Error(`Failed to ${o}. ${e.message||"Please try again."}`)},c=async(o,e)=>{try{const t={title:e.title,weight:parseFloat(e.weight)||1};if(e.dueDate){const r=new Date(e.dueDate);isNaN(r)||(t.dueDate=r.toISOString().slice(0,10))}const s={goalId:o,...t};return console.log("Creating milestone with data:",s),(await a.post("/milestones",s)).data}catch(t){i("creating milestone",t)}},d=async(o,e)=>{var t;try{const s={};if(e.title!==void 0&&(s.title=e.title),e.weight!==void 0&&(s.weight=parseFloat(e.weight)||1),e.dueDate!==void 0)if(e.dueDate){const n=new Date(e.dueDate);s.dueDate=isNaN(n)?null:n.toISOString().slice(0,10)}else s.dueDate=null;if(e.done!==void 0)try{return console.log("Trying PATCH for milestone done status"),(await a.patch(`/milestones/${o}`,{done:e.done})).data}catch(n){console.log("PATCH failed, falling back to PUT:",n),s.done=e.done}console.log("Updating milestone with data:",s);try{return(await a.put(`/milestones/${o}`,s)).data}catch(n){if(((t=n.response)==null?void 0:t.status)===404)return console.log("PUT not supported, trying PATCH"),(await a.patch(`/milestones/${o}`,s)).data;throw n}}catch(s){i("updating milestone",s)}};export{c as createMilestone,d as updateMilestone};
