import{c as F,r as o,j as e,C as T,P as z,T as E}from"./index-CSUE7nBL.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],U=F("chevron-left",H),L=({onClose:p,onGoalCreated:C,keyAreas:S=[],goal:a,isEditing:x=!1})=>{var D;const[n,I]=o.useState({title:(a==null?void 0:a.title)||"",description:(a==null?void 0:a.description)||"",startDate:a!=null&&a.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",dueDate:a!=null&&a.dueDate?new Date(a.dueDate).toISOString().split("T")[0]:"",keyAreaId:(a==null?void 0:a.keyAreaId)||"",status:(a==null?void 0:a.status)||"active",visibility:(a==null?void 0:a.visibility)||"public"}),[l,h]=o.useState(((D=a==null?void 0:a.milestones)==null?void 0:D.length)>0?a.milestones.map(t=>({id:t.id,title:t.title,weight:t.weight||1,dueDate:t.dueDate||""})):[{title:"",weight:1,dueDate:""}]),[i,m]=o.useState(0),[N,k]=o.useState(!1),[d,b]=o.useState({}),f=o.useRef(null),g=o.useRef(null),y=o.useRef(null),v=o.useRef(null),c=(t,s)=>{I(r=>({...r,[t]:s})),d[t]&&b(r=>({...r,[t]:null}))},j=(t,s)=>{const r=[...l];r[i]={...r[i],[t]:s},h(r)},_=()=>{if(l.length>=10)return;const t=[...l,{title:"",weight:1,dueDate:""}];h(t),m(t.length-1)},A=()=>{if(l.length===1)return;const t=l.filter((r,u)=>u!==i);let s=i;s>=t.length&&(s=t.length-1),h(t),m(s)},M=()=>{i!==0&&m(t=>t-1)},P=()=>{i>=l.length-1||m(t=>t+1)},R=()=>{const t={};if(n.title.trim()?n.title.length<3&&(t.title="Title must be at least 3 characters"):t.title="Title is required",!n.dueDate)t.dueDate="Deadline is required";else{const s=new Date(n.dueDate),r=new Date;r.setHours(0,0,0,0),s<=r&&!x&&(t.dueDate="Deadline must be in the future")}return b(t),Object.keys(t).length===0},O=async()=>{if(!R())return;k(!0);const t={title:n.title.trim(),description:n.description?n.description.trim():null,startDate:n.startDate||null,dueDate:n.dueDate,keyAreaId:n.keyAreaId||null,visibility:n.visibility,status:n.status,milestones:l.filter(s=>s.title.trim()).map(s=>({...s.id&&{id:s.id},title:s.title.trim(),weight:parseFloat(s.weight)||1,dueDate:s.dueDate||null}))};try{await C(t),p()}catch(s){b({general:s.message||"Failed to save goal. Please try again."})}finally{k(!1)}},w=l[i]||{title:"",weight:1,dueDate:""};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-fadeIn",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:()=>p(),children:[e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slideUp {
          from { 
            opacity: 0;
            transform: translateY(20px);
          }
          to { 
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fadeIn {
          animation: fadeIn 0.2s ease-out;
        }
        .animate-slideUp {
          animation: slideUp 0.3s ease-out;
        }
        /* Hide native inline date-picker indicator for inputs using .no-calendar
           Keep the separate ðŸ“… button visible and functional. */
        input.no-calendar::-webkit-calendar-picker-indicator {
          opacity: 0;
          pointer-events: none;
          display: block;
          width: 0;
          height: 0;
        }
        /* Also hide clear/spinner controls in WebKit browsers */
        input.no-calendar::-webkit-clear-button,
        input.no-calendar::-webkit-inner-spin-button {
          display: none;
        }
        /* Ensure appearance none for consistent look */
        input.no-calendar { -webkit-appearance: none; appearance: none; }
        /* Firefox - hide calendar picker appearance */
        input.no-calendar::-moz-focus-inner { border: 0; }
      `}),e.jsxs("div",{className:"relative bg-white rounded-xl w-full max-w-3xl shadow-2xl flex flex-col animate-slideUp max-h-[90vh] overflow-hidden border border-gray-200",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"relative flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[e.jsx("div",{className:"w-10","aria-hidden":"true"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 absolute left-1/2 transform -translate-x-1/2",children:x?"Edit Goal":"Add Goal"}),e.jsx("button",{type:"button",onClick:p,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200","aria-label":"Close",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-x w-5 h-5","aria-hidden":"true",children:[e.jsx("path",{d:"M18 6 6 18"}),e.jsx("path",{d:"m6 6 12 12"})]})})]}),e.jsxs("div",{className:"px-6 py-4 overflow-y-auto",children:[d.general&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border-l-4 border-red-500 rounded-r text-red-700 text-sm",children:[e.jsx("strong",{className:"font-medium",children:"Error:"})," ",d.general]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Goal name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.title,onChange:t=>c("title",t.target.value),className:`w-full px-3 py-2 text-sm border rounded-md focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent ${d.title?"border-red-300 bg-red-50":"border-gray-300"}`,placeholder:""}),d.title&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:d.title})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_auto_1fr] gap-y-6 md:gap-x-0.5",children:[e.jsxs("div",{className:"space-y-3 md:col-span-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:n.description,onChange:t=>c("description",t.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",placeholder:"Add a short description (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Start date"}),e.jsxs("div",{className:"relative mt-0",children:[e.jsx("input",{name:"start_date",ref:f,type:"date",value:n.startDate,onChange:t=>c("startDate",t.target.value),className:"left-focus w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-slate-900 shadow-sm placeholder-slate-400 focus:border-green-500 focus:ring-2 focus:ring-green-50 appearance-none pr-11 no-calendar"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-purple-600","aria-label":"Open date picker",onClick:()=>{var t,s,r;try{(s=(t=f.current)==null?void 0:t.showPicker)==null||s.call(t),(r=f.current)==null||r.focus()}catch{}},children:"ðŸ“…"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Deadline ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative mt-0",children:[e.jsx("input",{name:"due_date",required:!0,ref:g,type:"date",value:n.dueDate,onChange:t=>c("dueDate",t.target.value),className:`left-focus w-full rounded-lg px-3 py-2 text-slate-900 shadow-sm placeholder-slate-400 appearance-none pr-11 no-calendar focus:border-green-500 focus:ring-2 focus:ring-green-50 ${d.dueDate?"border-red-300 bg-red-50":"border-slate-300 bg-white"}`,min:new Date().toISOString().split("T")[0]}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-purple-600","aria-label":"Open date picker",onClick:()=>{var t,s,r;try{(s=(t=g.current)==null?void 0:t.showPicker)==null||s.call(t),(r=g.current)==null||r.focus()}catch{}},children:"ðŸ“…"})]}),d.dueDate&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:d.dueDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Area"}),e.jsxs("select",{value:n.keyAreaId,onChange:t=>c("keyAreaId",t.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select key area"}),S.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Visibility"}),e.jsxs("select",{value:n.visibility,onChange:t=>c("visibility",t.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[e.jsx("option",{value:"public",children:"Public"}),e.jsx("option",{value:"private",children:"Private"})]})]})]}),e.jsx("div",{className:"hidden md:flex md:items-stretch md:justify-center md:col-span-1",children:e.jsx("div",{className:"w-px bg-slate-400 my-2"})}),e.jsxs("div",{className:"space-y-3 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:M,disabled:i===0,className:"p-1 rounded-md border border-gray-300 text-gray-600 text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(U,{className:"w-3 h-3"})}),e.jsxs("span",{className:"text-sm font-medium text-gray-800",children:["Milestones (",i+1,"/10)"]}),e.jsx("button",{type:"button",onClick:P,disabled:i>=l.length-1,className:"p-1 rounded-md border border-gray-300 text-gray-600 text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(T,{className:"w-3 h-3"})})]}),e.jsxs("button",{type:"button",onClick:_,disabled:l.length>=10,className:"flex items-center gap-1 text-xs font-medium text-blue-600 hover:text-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(z,{className:"w-3 h-3"}),"Add"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name of milestone"}),e.jsx("input",{type:"text",value:w.title,onChange:t=>j("title",t.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Start date"}),e.jsxs("div",{className:"relative mt-0",children:[e.jsx("input",{name:"start_date",ref:y,type:"date",value:n.startDate,onChange:t=>c("startDate",t.target.value),className:"left-focus w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-slate-900 shadow-sm placeholder-slate-400 focus:border-green-500 focus:ring-2 focus:ring-green-50 appearance-none pr-11 no-calendar"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-purple-600","aria-label":"Open date picker",onClick:()=>{var t,s,r;try{(s=(t=y.current)==null?void 0:t.showPicker)==null||s.call(t),(r=y.current)==null||r.focus()}catch{}},children:"ðŸ“…"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Deadline"}),e.jsxs("div",{className:"relative mt-0",children:[e.jsx("input",{name:`milestone_due_${i}`,ref:v,type:"date",value:w.dueDate,onChange:t=>j("dueDate",t.target.value),className:"left-focus w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-slate-900 shadow-sm placeholder-slate-400 focus:border-green-500 focus:ring-2 focus:ring-green-50 appearance-none pr-11 no-calendar"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-purple-600","aria-label":"Open date picker",onClick:()=>{var t,s,r;try{(s=(t=v.current)==null?void 0:t.showPicker)==null||s.call(t),(r=v.current)==null||r.focus()}catch{}},children:"ðŸ“…"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),e.jsx("input",{type:"number",min:"0.1",step:"0.1",value:w.weight,onChange:t=>j("weight",t.target.value===""?"":parseFloat(t.target.value)),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("button",{type:"button",onClick:A,disabled:l.length===1,className:"inline-flex ml-auto block items-center gap-1 text-xs text-red-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(E,{className:"w-3 h-3"}),"Delete milestone"]})]})]})]}),e.jsx("div",{className:"flex justify-end gap-3 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[e.jsxs("button",{type:"submit",onClick:O,disabled:N,className:"rounded-md bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2 px-4 py-2 text-sm",children:[e.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 448 512",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"})}),N?"Saving...":x?"Update":"Save"]}),e.jsx("button",{type:"button",onClick:p,className:"rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50",disabled:!0,children:"Help"})]})})]})]})};export{L as default};
