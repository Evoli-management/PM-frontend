import{u as N,r,o as S,j as e,F as v,c as M,t as U}from"./index-BQ_vucUn.js";function z({isOpen:o,onClose:c,task:s,onDelegated:x}){var j,p;const{addToast:i}=N?N():{addToast:()=>{}},[m,k]=r.useState([]),[l,u]=r.useState(""),[b,h]=r.useState(""),[g,y]=r.useState(!1),[w,f]=r.useState(!1);r.useEffect(()=>{o&&(T(),u(""),h(""))},[o]);const T=async()=>{f(!0);try{const t=await S.getOrganizationMembers();k(t||[])}catch(t){console.error("Failed to load members:",t),i({title:"Failed to load team members",variant:"error"})}finally{f(!1)}},F=async()=>{var t,d;if(!l){i({title:"Please select a team member",variant:"warning"});return}y(!0);try{const n=await U.delegateTask(s.id,{delegatedToUserId:l,notes:b.trim()||void 0});i({title:"Task delegated successfully",variant:"success"}),x==null||x(n),c()}catch(n){console.error("Failed to delegate task:",n),i({title:((d=(t=n.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to delegate task",variant:"error"})}finally{y(!1)}};if(!o)return null;const a=m.find(t=>(t.userId||t.id)===l);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delegate Task"})]}),e.jsx("button",{onClick:c,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:e.jsx(M,{})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:(s==null?void 0:s.title)||"Task"}),(s==null?void 0:s.description)&&e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:s.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Delegate to:"}),w?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading team members..."}):e.jsxs("select",{value:l,onChange:t=>u(t.target.value),className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg
                                         bg-white dark:bg-gray-700 text-gray-900 dark:text-white
                                         focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,children:[e.jsx("option",{value:"",children:"Select team member..."}),m.map(t=>{const d=t.userId||t.id;return e.jsxs("option",{value:d,children:[t.firstName," ",t.lastName," (",t.email,")",t.role&&` - ${t.role}`]},d)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes (optional):"}),e.jsx("textarea",{value:b,onChange:t=>h(t.target.value),placeholder:"Add any context or instructions...",rows:3,className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg
                                     bg-white dark:bg-gray-700 text-gray-900 dark:text-white
                                     focus:ring-2 focus:ring-blue-500 focus:border-blue-500
                                     resize-none`})]}),a&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Delegating to:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.avatarUrl?e.jsx("img",{src:a.avatarUrl,alt:a.firstName,className:"w-8 h-8 rounded-full"}):e.jsxs("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white text-sm font-medium",children:[(j=a.firstName)==null?void 0:j[0],(p=a.lastName)==null?void 0:p[0]]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[a.firstName," ",a.lastName]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:a.email})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:c,disabled:g,className:`px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300
                                 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg
                                 disabled:opacity-50 disabled:cursor-not-allowed`,children:"Cancel"}),e.jsx("button",{onClick:F,disabled:g||!l,className:`px-4 py-2 text-sm font-medium text-white bg-blue-600
                                 hover:bg-blue-700 rounded-lg
                                 disabled:opacity-50 disabled:cursor-not-allowed
                                 flex items-center gap-2`,children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Delegating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{}),"Delegate Task"]})})]})]})})}export{z as default};
