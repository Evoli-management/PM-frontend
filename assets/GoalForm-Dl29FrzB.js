import{c as O,r as l,j as t,C as U,T as G}from"./index-B9B0rrBw.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],V=O("chevron-left",L);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$=O("plus",W),B=({onClose:f,onGoalCreated:M,keyAreas:T=[],goal:s,isEditing:x=!1})=>{var _;const o=new Date().toISOString().split("T")[0],[n,j]=l.useState({title:(s==null?void 0:s.title)||"",description:(s==null?void 0:s.description)||"",startDate:s!=null&&s.startDate?new Date(s.startDate).toISOString().split("T")[0]:o,dueDate:s!=null&&s.dueDate?new Date(s.dueDate).toISOString().split("T")[0]:o,keyAreaId:(s==null?void 0:s.keyAreaId)||"",status:(s==null?void 0:s.status)||"active",visibility:(s==null?void 0:s.visibility)||"public"}),[d,h]=l.useState(((_=s==null?void 0:s.milestones)==null?void 0:_.length)>0?s.milestones.map(e=>({id:e.id,title:e.title,weight:e.weight||1,startDate:e.startDate?new Date(e.startDate).toISOString().split("T")[0]:"",dueDate:e.dueDate?new Date(e.dueDate).toISOString().split("T")[0]:""})):[{title:"",weight:1,startDate:o,dueDate:o}]);l.useEffect(()=>{var e;s&&(j({title:(s==null?void 0:s.title)||"",description:(s==null?void 0:s.description)||"",startDate:s!=null&&s.startDate?new Date(s.startDate).toISOString().split("T")[0]:o,dueDate:s!=null&&s.dueDate?new Date(s.dueDate).toISOString().split("T")[0]:o,keyAreaId:(s==null?void 0:s.keyAreaId)||"",status:(s==null?void 0:s.status)||"active",visibility:(s==null?void 0:s.visibility)||"public"}),h(((e=s==null?void 0:s.milestones)==null?void 0:e.length)>0?s.milestones.map(r=>({id:r.id,title:r.title,weight:r.weight||1,startDate:r.startDate?new Date(r.startDate).toISOString().split("T")[0]:"",dueDate:r.dueDate?new Date(r.dueDate).toISOString().split("T")[0]:""})):[{title:"",weight:1,startDate:o,dueDate:o}]),b(0),y.current=s!=null&&s.startDate?new Date(s.startDate).toISOString().split("T")[0]:o)},[s]);const[i,b]=l.useState(0),[C,I]=l.useState(!1),[u,w]=l.useState({}),y=l.useRef(n.startDate),g=l.useRef(null),N=l.useRef(null),k=l.useRef(null),S=l.useRef(null),m=(e,r)=>{j(a=>({...a,[e]:r})),u[e]&&w(a=>({...a,[e]:null}))};l.useEffect(()=>{if(x){y.current=n.startDate;return}const e=y.current,r=n.startDate;j(a=>!a.dueDate||a.dueDate===e?{...a,dueDate:r}:a),h(a=>a.map(p=>{const c={...p};return(!c.startDate||c.startDate===e)&&(c.startDate=r),(!c.dueDate||c.dueDate===e)&&(c.dueDate=r),c})),y.current=r},[n.startDate,x]);const v=(e,r)=>{var A;const a=[...d],p=(A=a[i])==null?void 0:A.startDate,c={...a[i],[e]:r};e==="startDate"&&(!a[i].dueDate||a[i].dueDate===p)&&(c.dueDate=r),a[i]=c,h(a)},R=()=>{if(d.length>=10)return;const e=[...d,{title:"",weight:1,startDate:"",dueDate:""}];h(e),b(e.length-1)},P=()=>{if(d.length===1)return;const e=d.filter((a,p)=>p!==i);let r=i;r>=e.length&&(r=e.length-1),h(e),b(r)},F=()=>{i!==0&&b(e=>e-1)},z=()=>{i>=d.length-1||b(e=>e+1)},E=()=>{const e={};if(n.title.trim()?n.title.length<3&&(e.title="Title must be at least 3 characters"):e.title="Title is required",!n.dueDate)e.dueDate="Deadline is required";else{const r=new Date(n.dueDate),a=new Date;a.setHours(0,0,0,0),r<a&&!x&&(e.dueDate="Deadline must be today or in the future")}return w(e),Object.keys(e).length===0},H=async()=>{if(!E())return;I(!0);const e={title:n.title.trim(),description:n.description?n.description.trim():null,startDate:n.startDate||null,dueDate:n.dueDate,keyAreaId:n.keyAreaId||null,visibility:n.visibility,status:n.status,milestones:d.filter(r=>r.title.trim()).map(r=>({...r.id&&{id:r.id},title:r.title.trim(),weight:parseFloat(r.weight)||1,startDate:r.startDate||null,dueDate:r.dueDate||null}))};try{await M(e),f()}catch(r){w({general:r.message||"Failed to save goal. Please try again."})}finally{I(!1)}},D=d[i]||{title:"",weight:1,startDate:"",dueDate:""};return t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-fadeIn",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:()=>f(),children:[t.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slideUp {
          from { 
            opacity: 0;
            transform: translateY(20px);
          }
          to { 
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fadeIn {
          animation: fadeIn 0.2s ease-out;
        }
        .animate-slideUp {
          animation: slideUp 0.3s ease-out;
        }
        /* Hide native inline date-picker indicator for inputs using .no-calendar
           Keep the separate ðŸ“… button visible and functional. */
        input.no-calendar::-webkit-calendar-picker-indicator {
          opacity: 0;
          pointer-events: none;
          display: block;
          width: 0;
          height: 0;
        }
        /* Also hide clear/spinner controls in WebKit browsers */
        input.no-calendar::-webkit-clear-button,
        input.no-calendar::-webkit-inner-spin-button {
          display: none;
        }
        /* Ensure appearance none for consistent look */
        input.no-calendar { -webkit-appearance: none; appearance: none; }
        /* Firefox - hide calendar picker appearance */
        input.no-calendar::-moz-focus-inner { border: 0; }
      `}),t.jsxs("div",{className:"relative bg-white rounded-xl w-full max-w-3xl shadow-2xl flex flex-col animate-slideUp max-h-[90vh] overflow-hidden border border-gray-200",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"relative flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[t.jsx("div",{className:"w-10","aria-hidden":"true"}),t.jsx("h2",{className:"text-xl font-semibold text-gray-900 absolute left-1/2 transform -translate-x-1/2",children:x?"Edit Goal":"Add Goal"}),t.jsx("button",{type:"button",onClick:f,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200","aria-label":"Close",children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-x w-5 h-5","aria-hidden":"true",children:[t.jsx("path",{d:"M18 6 6 18"}),t.jsx("path",{d:"m6 6 12 12"})]})})]}),t.jsxs("div",{className:"px-6 py-4 overflow-y-auto",children:[u.general&&t.jsxs("div",{className:"mb-4 p-3 bg-red-50 border-l-4 border-red-500 rounded-r text-red-700 text-sm",children:[t.jsx("strong",{className:"font-medium",children:"Error:"})," ",u.general]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Goal name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:n.title,onChange:e=>m("title",e.target.value),className:`w-full px-3 py-2 text-sm border rounded-md focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent ${u.title?"border-red-300 bg-red-50":"border-gray-300"}`,placeholder:""}),u.title&&t.jsx("p",{className:"text-red-600 text-xs mt-1",children:u.title})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_auto_1fr] gap-y-6 md:gap-x-0.5",children:[t.jsxs("div",{className:"space-y-3 md:col-span-1",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),t.jsx("input",{type:"text",value:n.description,onChange:e=>m("description",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",placeholder:"Add a short description (optional)"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Start date"}),t.jsxs("div",{className:"relative mt-0",children:[t.jsx("input",{name:"start_date",ref:g,type:"date",value:n.startDate,onChange:e=>m("startDate",e.target.value),className:"left-focus w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-slate-900 shadow-sm placeholder-slate-400 focus:border-green-500 focus:ring-2 focus:ring-green-50 appearance-none pr-11 no-calendar"}),t.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-purple-600","aria-label":"Open date picker",onClick:()=>{var e,r,a;try{(r=(e=g.current)==null?void 0:e.showPicker)==null||r.call(e),(a=g.current)==null||a.focus()}catch{}},children:"ðŸ“…"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Deadline ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{className:"relative mt-0",children:[t.jsx("input",{name:"due_date",required:!0,ref:N,type:"date",value:n.dueDate,onChange:e=>m("dueDate",e.target.value),className:`left-focus w-full rounded-lg px-3 py-2 text-slate-900 shadow-sm placeholder-slate-400 appearance-none pr-11 no-calendar focus:border-green-500 focus:ring-2 focus:ring-green-50 ${u.dueDate?"border-red-300 bg-red-50":"border-slate-300 bg-white"}`,min:new Date().toISOString().split("T")[0]}),t.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-purple-600","aria-label":"Open date picker",onClick:()=>{var e,r,a;try{(r=(e=N.current)==null?void 0:e.showPicker)==null||r.call(e),(a=N.current)==null||a.focus()}catch{}},children:"ðŸ“…"})]}),u.dueDate&&t.jsx("p",{className:"text-red-600 text-xs mt-1",children:u.dueDate})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Area"}),t.jsxs("select",{value:n.keyAreaId,onChange:e=>m("keyAreaId",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select key area"}),T.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Visibility"}),t.jsxs("select",{value:n.visibility,onChange:e=>m("visibility",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[t.jsx("option",{value:"public",children:"Public"}),t.jsx("option",{value:"private",children:"Private"})]})]})]}),t.jsx("div",{className:"hidden md:flex md:items-stretch md:justify-center md:col-span-1",children:t.jsx("div",{className:"w-px bg-slate-400 my-2"})}),t.jsxs("div",{className:"space-y-3 md:col-span-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{type:"button",onClick:F,disabled:i===0,className:"p-1 rounded-md border border-gray-300 text-gray-600 text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(V,{className:"w-3 h-3"})}),t.jsxs("span",{className:"text-sm font-medium text-gray-800",children:["Milestones (",i+1,"/10)"]}),t.jsx("button",{type:"button",onClick:z,disabled:i>=d.length-1,className:"p-1 rounded-md border border-gray-300 text-gray-600 text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(U,{className:"w-3 h-3"})})]}),t.jsxs("button",{type:"button",onClick:R,disabled:d.length>=10,className:"flex items-center gap-1 text-xs font-medium text-blue-600 hover:text-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx($,{className:"w-3 h-3"}),"Add"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name of milestone"}),t.jsx("input",{type:"text",value:D.title,onChange:e=>v("title",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Start date"}),t.jsxs("div",{className:"relative mt-0",children:[t.jsx("input",{name:"start_date",ref:k,type:"date",value:D.startDate,onChange:e=>v("startDate",e.target.value),className:"left-focus w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-slate-900 shadow-sm placeholder-slate-400 focus:border-green-500 focus:ring-2 focus:ring-green-50 appearance-none pr-11 no-calendar"}),t.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-purple-600","aria-label":"Open date picker",onClick:()=>{var e,r,a;try{(r=(e=k.current)==null?void 0:e.showPicker)==null||r.call(e),(a=k.current)==null||a.focus()}catch{}},children:"ðŸ“…"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Deadline"}),t.jsxs("div",{className:"relative mt-0",children:[t.jsx("input",{name:`milestone_due_${i}`,ref:S,type:"date",value:D.dueDate,onChange:e=>v("dueDate",e.target.value),className:"left-focus w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-slate-900 shadow-sm placeholder-slate-400 focus:border-green-500 focus:ring-2 focus:ring-green-50 appearance-none pr-11 no-calendar"}),t.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-purple-600","aria-label":"Open date picker",onClick:()=>{var e,r,a;try{(r=(e=S.current)==null?void 0:e.showPicker)==null||r.call(e),(a=S.current)==null||a.focus()}catch{}},children:"ðŸ“…"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),t.jsx("input",{type:"number",min:"0.1",step:"0.1",value:D.weight,onChange:e=>v("weight",e.target.value===""?"":parseFloat(e.target.value)),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),t.jsxs("button",{type:"button",onClick:P,disabled:d.length===1,className:"inline-flex ml-auto block items-center gap-1 text-xs text-red-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(G,{className:"w-3 h-3"}),"Delete milestone"]})]})]})]}),t.jsx("div",{className:"flex justify-end gap-3 px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[t.jsxs("button",{type:"submit",onClick:H,disabled:C,className:"rounded-md bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2 px-4 py-2 text-sm",children:[t.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 448 512",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"})}),C?"Saving...":x?"Update":"Save"]}),t.jsx("button",{type:"button",onClick:f,className:"rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50",children:"Cancel"}),t.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50",disabled:!0,children:"Help"})]})})]})]})};export{B as default};
