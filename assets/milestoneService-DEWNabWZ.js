import{a as r}from"./index-Cp80VrkK.js";const a=(o,e)=>{if(console.error(`Error ${o}:`,e),e.response&&e.response.data&&e.response.data.message){const s=Array.isArray(e.response.data.message)?e.response.data.message.join(", "):e.response.data.message;throw console.error("Backend validation errors:",s),new Error(`Failed to ${o}. ${s}`)}throw new Error(`Failed to ${o}. ${e.message||"Please try again."}`)},d=async(o,e)=>{try{const s={title:e.title,weight:parseFloat(e.weight)||1};if(e.dueDate){const i=new Date(e.dueDate);isNaN(i)||(s.dueDate=i.toISOString().slice(0,10))}const t={goalId:o,...s};return console.log("Creating milestone with data:",t),(await r.post("/milestones",t)).data}catch(s){a("creating milestone",s)}},l=async(o,e)=>{var s;try{const t={};if(e.title!==void 0&&(t.title=e.title),e.weight!==void 0&&(t.weight=parseFloat(e.weight)||1),e.score!==void 0){const n=parseFloat(e.score);t.score=isNaN(n)?null:n}if(e.dueDate!==void 0)if(e.dueDate){const n=new Date(e.dueDate);t.dueDate=isNaN(n)?null:n.toISOString().slice(0,10)}else t.dueDate=null;if(e.done!==void 0)try{return console.log("Trying PATCH for milestone done status"),(await r.patch(`/milestones/${o}`,{done:e.done})).data}catch(n){console.log("PATCH failed, falling back to PUT:",n),t.done=e.done}console.log("Updating milestone with data:",t);try{return(await r.put(`/milestones/${o}`,t)).data}catch(n){if(((s=n.response)==null?void 0:s.status)===404)return console.log("PUT not supported, trying PATCH"),(await r.patch(`/milestones/${o}`,t)).data;throw n}}catch(t){a("updating milestone",t)}},g=async(o,e)=>{var s;try{console.log(`Marking milestone ${o} as ${e?"done":"not done"}`);try{return(await r.patch(`/milestones/${o}/${e?"complete":"uncomplete"}`)).data}catch(t){if(((s=t.response)==null?void 0:s.status)===404)return console.log("Toggle endpoint not found, using regular update"),await l(o,{done:e});throw t}}catch(t){a(`marking milestone as ${e?"done":"not done"}`,t)}},p=async o=>{var e;try{console.log("Deleting milestone:",o);try{return await r.delete(`/milestones/${o}`),!0}catch(s){if(((e=s.response)==null?void 0:e.status)===404)return console.log("DELETE not supported, trying to mark as deleted"),await r.patch(`/milestones/${o}`,{deleted:!0}),!0;throw s}}catch(s){a("deleting milestone",s)}};export{d as createMilestone,p as deleteMilestone,g as toggleMilestoneDone,l as updateMilestone};
